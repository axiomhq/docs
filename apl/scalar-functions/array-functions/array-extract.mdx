---
title: array_extract
description: 'This page explains how to use the array_extract function in APL.'
---

Use the `array_extract` function to extract a subarray from a source array. You can specify the starting index and the number of elements to return. This function is especially useful when you need to analyze or manipulate only part of an array—for example, inspecting the top few values in a sorted array or trimming noise from a large data structure.

Use `array_extract` when:

- You want to retrieve a specific window of values from an array.
- You need to isolate part of an array for further aggregation, filtering, or formatting.
- You are working with data transformations that involve slicing arrays across time, services, or user sessions.

## For users of other query languages

If you come from other query languages, this section explains how to adjust your existing queries to achieve the same results in APL.

<AccordionGroup>
<Accordion title="Splunk SPL users">

Splunk SPL doesn’t provide a direct equivalent of `array_extract`, but you can achieve similar functionality using the `mvindex` function to extract specific elements from a multivalue field.

<CodeGroup>
```sql Splunk example
| eval arr=split("a,b,c,d,e", ",")
| eval subarr=mvindex(arr, 1, 3)
````

```kusto APL equivalent
print arr=dynamic(["a", "b", "c", "d", "e"])
| extend subarr=array_extract(arr, 1, 3)
```

</CodeGroup>

</Accordion>
<Accordion title="ANSI SQL users">

ANSI SQL doesn’t support arrays as first-class data types in the same way APL does. To simulate `array_extract`, you typically need a separate table and use `LIMIT` and `OFFSET` clauses. In APL, `array_extract` provides a concise way to get a slice of an array without flattening it into rows.

<CodeGroup>
```sql SQL example
SELECT value
FROM (SELECT value FROM my_array_table LIMIT 3 OFFSET 1) sub;
```

```kusto APL equivalent
print arr=dynamic(["a", "b", "c", "d", "e"])
| extend subarr=array_extract(arr, 1, 3)
```

</CodeGroup>

</Accordion>
</AccordionGroup>

## Usage

### Syntax

```kusto
array_extract(sourceArray, regex)
```

### Parameters

| Name          | Type      | Description                                                  |
| ------------- | --------- | ------------------------------------------------------------ |
| `sourceArray` | `dynamic` | The array to extract from.                                   |
| `regex`  | `int`     | The 0-based index to start extraction from.                  |

### Returns

A dynamic array containing the extracted elements. If the range exceeds the bounds of the array, only the elements within bounds are returned. If `startIndex` is beyond the array length, an empty array is returned.

## Example

Use `array_extract` to 

**Query**

```kusto
['sample-http-logs']
| extend extracted_value = array_extract(dynamic([{'id': 1, 'value': true}, {'id': 2, 'value': false}]), @'$[*].value')
| project _time, extracted_value
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D%20%7C%20extend%20extracted_value%20%3D%20array_extract(dynamic(%5B%7B'id'%3A%201%2C%20'value'%3A%20true%7D%2C%20%7B'id'%3A%202%2C%20'value'%3A%20false%7D%5D)%2C%20%40'%24%5B*%5D.value')%20%7C%20project%20_time%2C%20extracted_value%22%7D)

**Output**

| _time | extracted_value |
| ------- | ------- |
| Jun 24, 09:28:10     | ["true", "false"]    |
| Jun 24, 09:28:10     | ["true", "false"]    |
| Jun 24, 09:28:10     | ["true", "false"]    |

## List of related functions

- [array_slice](/apl/scalar-functions/array-functions/array-slice): Returns a subarray like `array_extract`, but supports negative indexing.
- [array_length](/apl/scalar-functions/array-functions/array-length): Returns the number of elements in an array. Useful before applying `array_extract`.
- [array_concat](/apl/scalar-functions/array-functions/array-concat): Joins arrays end-to-end. Use before or after slicing arrays with `array_extract`.
- [array_index_of](/apl/scalar-functions/array-functions/array-index-of): Finds the position of an element in an array, which can help set the `startIndex` for `array_extract`.
