---
title: array_extract
description: 'This page explains how to use the array_extract function in APL.'
---

Use the `array_extract` function to extract a subarray from a source array. You can specify the starting index and the number of elements to return. This function is especially useful when you need to analyze or manipulate only part of an array—for example, inspecting the top few values in a sorted array or trimming noise from a large data structure.

Use `array_extract` when:

- You want to retrieve a specific window of values from an array.
- You need to isolate part of an array for further aggregation, filtering, or formatting.
- You are working with data transformations that involve slicing arrays across time, services, or user sessions.

## For users of other query languages

If you come from other query languages, this section explains how to adjust your existing queries to achieve the same results in APL.

<AccordionGroup>
<Accordion title="Splunk SPL users">

Splunk SPL doesn’t provide a direct equivalent of `array_extract`, but you can achieve similar functionality using the `mvindex` function to extract specific elements from a multivalue field.

<CodeGroup>
```sql Splunk example
| eval arr=split("a,b,c,d,e", ",")
| eval subarr=mvindex(arr, 1, 3)
````

```kusto APL equivalent
print arr=dynamic(["a", "b", "c", "d", "e"])
| extend subarr=array_extract(arr, 1, 3)
```

</CodeGroup>

</Accordion>
<Accordion title="ANSI SQL users">

ANSI SQL doesn’t support arrays as first-class data types in the same way APL does. To simulate `array_extract`, you typically need a separate table and use `LIMIT` and `OFFSET` clauses. In APL, `array_extract` provides a concise way to get a slice of an array without flattening it into rows.

<CodeGroup>
```sql SQL example
SELECT value
FROM (SELECT value FROM my_array_table LIMIT 3 OFFSET 1) sub;
```

```kusto APL equivalent
print arr=dynamic(["a", "b", "c", "d", "e"])
| extend subarr=array_extract(arr, 1, 3)
```

</CodeGroup>

</Accordion>
</AccordionGroup>

## Usage

### Syntax

```kusto
array_extract(sourceArray, startIndex, length)
```

### Parameters

| Name          | Type      | Description                                                  |
| ------------- | --------- | ------------------------------------------------------------ |
| `sourceArray` | `dynamic` | The array to extract from.                                   |
| `startIndex`  | `int`     | The 0-based index to start extraction from.                  |
| `length`      | `int`     | The number of elements to include in the extracted subarray. |

### Returns

A dynamic array containing the extracted elements. If the range exceeds the bounds of the array, only the elements within bounds are returned. If `startIndex` is beyond the array length, an empty array is returned.

## Use case examples

<Tabs>
<Tab title="Log analysis">

Use `array_extract` to inspect a moving window of request durations grouped by user ID. This helps you analyze performance outliers across request sequences.

**Query**

```kusto
['sample-http-logs']
| summarize durations=make_list(req_duration_ms) by id
| extend sorted=sort_array(durations, 'desc')
| extend top_3=array_extract(sorted, 0, 3)
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D%20%7C%20summarize%20durations%3Dmake_list%28req_duration_ms%29%20by%20id%20%7C%20extend%20sorted%3Dsort_array%28durations%2C%20'desc'%29%20%7C%20extend%20top_3%3Darray_extract%28sorted%2C%200%2C%203%29%22%7D)

**Output**

| id    | durations             | sorted                | top_3           |
| ----- | --------------------- | --------------------- | ---------------- |
| user1 | [200, 120, 300, 150] | [300, 200, 150, 120] | [300, 200, 150] |

This query extracts the top three longest request durations per user.

</Tab>
<Tab title="OpenTelemetry traces">

Use `array_extract` to focus on the longest spans of a trace to identify performance bottlenecks.

**Query**

```kusto
['otel-demo-traces']
| summarize spans=make_list(duration) by trace_id
| extend sorted=sort_array(spans, 'desc')
| extend slowest_2=array_extract(sorted, 0, 2)
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'otel-demo-traces'%5D%20%7C%20summarize%20spans%3Dmake_list%28duration%29%20by%20trace_id%20%7C%20extend%20sorted%3Dsort_array%28spans%2C%20'desc'%29%20%7C%20extend%20slowest_2%3Darray_extract%28sorted%2C%200%2C%202%29%22%7D)

**Output**

| trace_id | spans                            | sorted                           | slowest_2                    |
| --------- | -------------------------------- | -------------------------------- | ----------------------------- |
| abc123    | [00:00:01.200, 00:00:00.900, …] | [00:00:01.200, 00:00:00.900, …] | [00:00:01.200, 00:00:00.900] |

This example slices the top two longest spans from each trace for targeted diagnostics.

</Tab>
<Tab title="Security logs">

Use `array_extract` to retrieve the first few URIs accessed during a security incident to detect potentially suspicious patterns.

**Query**

```kusto
['sample-http-logs']
| summarize uris=make_list(uri) by id
| extend first_uris=array_extract(uris, 0, 2)
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D%20%7C%20summarize%20uris%3Dmake_list%28uri%29%20by%20id%20%7C%20extend%20first_uris%3Darray_extract%28uris%2C%200%2C%202%29%22%7D)

**Output**

| id    | uris                               | first_uris           |
| ----- | ---------------------------------- | --------------------- |
| user1 | ['/admin', '/login', '/settings'] | ['/admin', '/login'] |

This query extracts the first two accessed URIs per user session for early threat detection.

</Tab>
</Tabs>

## List of related functions

- [array_slice](/apl/array-functions/array_slice): Returns a subarray like `array_extract`, but supports negative indexing.
- [array_length](/apl/array-functions/array_length): Returns the number of elements in an array. Useful before applying `array_extract`.
- [array_concat](/apl/array-functions/array_concat): Joins arrays end-to-end. Use before or after slicing arrays with `array_extract`.
- [array_index_of](/apl/array-functions/array_index_of): Finds the position of an element in an array, which can help set the `startIndex` for `array_extract`.
- [sort_array](/apl/array-functions/sort_array): Sorts array elements before applying `array_extract` to get top or bottom slices.
