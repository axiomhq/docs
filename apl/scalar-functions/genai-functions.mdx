---
title: 'GenAI functions'
description: 'This page provides an overview of GenAI functions in APL for analyzing and processing GenAI conversation data.'
---

GenAI functions in APL help you analyze and process GenAI conversation data, including messages, token usage, costs, and conversation metadata. These functions are useful when working with logs or data from large language models (LLMs) and AI systems.

## When to use GenAI functions

Use GenAI functions when you need to:

- Extract specific information from AI conversation logs, such as user prompts, assistant responses, or system prompts
- Calculate token costs and usage metrics for LLM API calls
- Analyze conversation structure and flow, including turn counts and message roles
- Process and filter conversation messages based on roles or content
- Determine pricing information for different AI models
- Detect truncation or tool calls in AI responses

## Available GenAI functions

| Function | Description |
|:---------|:------------|
| [genai_concat_contents](/apl/scalar-functions/genai-functions/genai-concat-contents) | Concatenates message contents from a conversation array |
| [genai_conversation_turns](/apl/scalar-functions/genai-functions/genai-conversation-turns) | Counts the number of conversation turns |
| [genai_cost](/apl/scalar-functions/genai-functions/genai-cost) | Calculates the total cost for input and output tokens |
| [genai_estimate_tokens](/apl/scalar-functions/genai-functions/genai-estimate-tokens) | Estimates the number of tokens in a text string |
| [genai_extract_assistant_response](/apl/scalar-functions/genai-functions/genai-extract-assistant-response) | Extracts the assistantâ€™s response from a conversation |
| [genai_extract_function_results](/apl/scalar-functions/genai-functions/genai-extract-function-results) | Extracts function call results from messages |
| [genai_extract_system_prompt](/apl/scalar-functions/genai-functions/genai-extract-system-prompt) | Extracts the system prompt from a conversation |
| [genai_extract_tool_calls](/apl/scalar-functions/genai-functions/genai-extract-tool-calls) | Extracts tool calls from messages |
| [genai_extract_user_prompt](/apl/scalar-functions/genai-functions/genai-extract-user-prompt) | Extracts the user prompt from a conversation |
| [genai_get_content_by_index](/apl/scalar-functions/genai-functions/genai-get-content-by-index) | Gets message content by index position |
| [genai_get_content_by_role](/apl/scalar-functions/genai-functions/genai-get-content-by-role) | Gets message content by role |
| [genai_get_pricing](/apl/scalar-functions/genai-functions/genai-get-pricing) | Gets pricing information for a specific model |
| [genai_get_role](/apl/scalar-functions/genai-functions/genai-get-role) | Gets the role of a message at a specific index |
| [genai_has_tool_calls](/apl/scalar-functions/genai-functions/genai-has-tool-calls) | Checks if messages contain tool calls |
| [genai_input_cost](/apl/scalar-functions/genai-functions/genai-input-cost) | Calculates the cost for input tokens |
| [genai_is_truncated](/apl/scalar-functions/genai-functions/genai-is-truncated) | Checks if a response was truncated |
| [genai_message_roles](/apl/scalar-functions/genai-functions/genai-message-roles) | Extracts all message roles from a conversation |
| [genai_output_cost](/apl/scalar-functions/genai-functions/genai-output-cost) | Calculates the cost for output tokens |

## Common use cases

### Analyzing conversation costs

Calculate the total cost of AI conversations across different models and usage patterns.

```kusto
['ai-logs']
| extend total_cost = genai_cost(model, input_tokens, output_tokens)
| summarize sum(total_cost) by model
```

### Extracting conversation components

Extract specific parts of conversations for analysis or debugging.

```kusto
['ai-logs']
| extend user_query = genai_extract_user_prompt(messages)
| extend ai_response = genai_extract_assistant_response(messages)
| project _time, user_query, ai_response
```

### Monitoring token usage

Track and analyze token consumption patterns.

```kusto
['ai-logs']
| extend estimated_tokens = genai_estimate_tokens(content)
| summarize avg(estimated_tokens), max(estimated_tokens) by model
```

