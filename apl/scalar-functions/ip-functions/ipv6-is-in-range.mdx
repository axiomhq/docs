---
title: ipv6_is_in_range
description: 'This page explains how to use the ipv6_is_in_range function in APL.'
---

Use the `ipv6_is_in_range` function to check whether an IPv6 address falls within a specified IPv6 CIDR range. This is useful when you need to classify, filter, or segment network traffic by address rangeâ€”such as identifying requests from internal subnets, geo-localized regional blocks, or known malicious networks.

You can use this function when analyzing HTTP logs, trace telemetry, or security events where IPv6 addresses are present, and you want to restrict attention to or exclude certain address ranges.

## For users of other query languages

If you come from other query languages, this section explains how to adjust your existing queries to achieve the same results in APL.

<AccordionGroup>
<Accordion title="Splunk SPL users">

In Splunk SPL, IP range checking for IPv6 addresses typically requires custom scripts or manual logic, as there is no built-in function equivalent to `ipv6_is_in_range`.

```sql Splunk example
| eval inRange=if(cidrmatch("2001:db8::/32", src_ip), "yes", "no")
````

```kusto APL equivalent
['sample-http-logs']
| extend inRange = ipv6_is_in_range(src_ip, '2001:db8::/32')
```

</Accordion>
<Accordion title="ANSI SQL users">

ANSI SQL does not have native functions for CIDR range checks on IPv6 addresses. You typically rely on user-defined functions (UDFs) or external tooling. In APL, `ipv6_is_in_range` provides this capability out of the box.

```sql SQL example
-- Using a hypothetical UDF
SELECT ipv6_in_range(ip_address, '2001:db8::/32') AS in_range FROM logs;
```

```kusto APL equivalent
['sample-http-logs']
| extend inRange = ipv6_is_in_range(src_ip, '2001:db8::/32')
```

</Accordion>
</AccordionGroup>

## Usage

### Syntax

```kusto
ipv6_is_in_range(ipv6: string, cidr_range: string)
```

### Parameters

| Name         | Type   | Description                                   |
| ------------ | ------ | --------------------------------------------- |
| `ipv6`       | string | The IPv6 address to check.                    |
| `cidr_range` | string | The IPv6 CIDR block (e.g. `'2001:db8::/32'`). |

### Returns

A `bool` value:

- `true` if the IPv6 address is within the specified CIDR range.
- `false` otherwise.

## Use case examples

<Tabs>
<Tab title="Log analysis">

Use this function to determine if incoming HTTP requests originate from a known IPv6 subnet.

**Query**

```kusto
['sample-http-logs']
| extend inRange = ipv6_is_in_range(id, '2001:db8::/32')
| where inRange
| project _time, id, uri, method, geo.country
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B%27sample-http-logs%27%5D](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B%27sample-http-logs%27%5D) %7C extend inRange %3D ipv6_is_in_range(id%2C '2001%3Adb8%3A%3A%2F32') %7C where inRange %7C project _time%2C id%2C uri%2C method%2C geo.country%22%7D)

**Output**

| _time               | id                   | uri           | method | geo.country |
| -------------------- | -------------------- | ------------- | ------ | ----------- |
| 2025-06-28T14:52:01Z | 2001:db8::1a2b:3c4d | /api/products | GET    | US          |
| 2025-06-28T14:53:45Z | 2001:db8::9a8b:7c6d | /api/cart     | POST   | US          |

This example filters HTTP logs to show only those with IPv6 addresses in the `2001:db8::/32` CIDR block.

</Tab>
<Tab title="OpenTelemetry traces">

Use this function to isolate internal service calls originating from a designated IPv6 block.

**Query**

```kusto
['otel-demo-traces']
| extend inRange = ipv6_is_in_range(trace_id, 'fd00::/8')
| where inRange
| project _time, trace_id, span_id, ['service.name'], duration
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B%27otel-demo-traces%27%5D](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B%27otel-demo-traces%27%5D) %7C extend inRange %3D ipv6_is_in_range(trace_id%2C 'fd00%3A%3A%2F8') %7C where inRange %7C project _time%2C trace_id%2C span_id%2C %5B%27service.name%27%5D%2C duration%22%7D)

**Output**

| _time               | trace_id  | span_id | ['service.name'] | duration   |
| -------------------- | ---------- | -------- | ----------------- | ---------- |
| 2025-06-28T11:20:00Z | fd00::a1b2 | span-124 | frontend          | 00:00:02.4 |
| 2025-06-28T11:21:03Z | fd00::bbcc | span-209 | cartservice       | 00:00:01.1 |

This example checks whether traces originated from internal addresses in the `fd00::/8` range, often reserved for local communications.

</Tab>
<Tab title="Security logs">

Use this function to detect potentially malicious access attempts from suspicious IPv6 ranges.

**Query**

```kusto
['sample-http-logs']
| extend isMalicious = ipv6_is_in_range(id, '2001:dead:beef::/48')
| where isMalicious
| summarize count() by uri, method
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B%27sample-http-logs%27%5D](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B%27sample-http-logs%27%5D) %7C extend isMalicious %3D ipv6_is_in_range(id%2C '2001%3Adead%3Abeef%3A%3A%2F48') %7C where isMalicious %7C summarize count()%20by%20uri%2C%20method%22%7D)

**Output**

| uri              | method | count_ |
| ---------------- | ------ | ------- |
| /admin/login     | POST   | 7       |
| /api/user/delete | DELETE | 3       |

This example flags suspicious requests from a known problematic IPv6 CIDR range and summarizes their frequency by endpoint.

</Tab>
</Tabs>

## List of related functions

- [ipv4_is_in_range](/apl/ip-functions/ipv4_is_in_range): Checks whether an IPv4 address is within a specified CIDR range. Use this function when working with IPv4 instead of IPv6.
- [ipv6_compare](/apl/ip-functions/ipv6_compare): Compares two IPv6 addresses. Use when you want to sort or test address equality or ordering.
- [ipv6_is_match](/apl/ip-functions/ipv6_is_match): Checks whether an IPv6 address matches a pattern. Use for wildcard or partial-match filtering rather than range checking.
- [ipv6_parse](/apl/ip-functions/ipv6_parse): Parses an IPv6 string into its binary representation. Use when you need to manipulate or analyze IPv6 addresses at the bit level.
- [parse_ipv6](/apl/ip-functions/parse_ipv6): Parses and validates an IPv6 string. Use to extract or verify IPv6 components before further processing.
