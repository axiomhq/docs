---
title: ipv6_is_match
description: 'This page explains how to use the ipv6_is_match function in APL.'
---

Use the `ipv6_is_match` function to determine whether an IPv6 address belongs to a specified IPv6 subnet. This function is useful when you want to classify, filter, or route network events based on IPv6 subnet membership. 

You can use `ipv6_is_match` in scenarios such as identifying traffic from a known address range, enforcing access control policies, or correlating logs to specific networks. It supports CIDR notation for subnet specification and returns a boolean value for each row in your dataset.

## For users of other query languages

If you come from other query languages, this section explains how to adjust your existing queries to achieve the same results in APL.

<AccordionGroup>
<Accordion title="Splunk SPL users">

Splunk SPL does not have a dedicated function for matching IPv6 addresses against CIDR blocks. You typically use regular expressions or custom lookups to perform similar checks. In contrast, APL provides a built-in function that directly evaluates IPv6 CIDR membership.

<CodeGroup>
```sql Splunk example
| eval is_in_subnet=if(match(ipv6_field, "^2001:db8::/32"), "true", "false")
````

```kusto APL equivalent
['sample-http-logs']
| extend is_in_subnet = ipv6_is_match('2001:db8:abcd:0012::0', '2001:db8::/32')
```

</CodeGroup>

</Accordion>
<Accordion title="ANSI SQL users">

ANSI SQL does not have a standard function to check if an IPv6 address belongs to a subnet. You often implement this logic with string manipulation or rely on database-specific functions. APL simplifies this with `ipv6_is_match`, which accepts a full IPv6 address and a subnet in CIDR notation.

<CodeGroup>
```sql SQL example
SELECT CASE 
  WHEN ip_address LIKE '2001:db8:%' THEN TRUE 
  ELSE FALSE 
END AS is_in_subnet
FROM logs
```

```kusto APL equivalent
['sample-http-logs']
| extend is_in_subnet = ipv6_is_match('2001:db8:abcd:0012::0', '2001:db8::/32')
```

</CodeGroup>

</Accordion>
</AccordionGroup>

## Usage

### Syntax

```kusto
ipv6_is_match(ipv6_address, ipv6_subnet)
```

### Parameters

| Name           | Type   | Description                                                |
| -------------- | ------ | ---------------------------------------------------------- |
| `ipv6_address` | string | The full IPv6 address you want to check.                   |
| `ipv6_subnet`  | string | The target subnet in CIDR notation, e.g., `2001:db8::/32`. |

### Returns

A boolean value:

- `true` if the `ipv6_address` belongs to the specified `ipv6_subnet`.
- `false` otherwise.

## Use case examples

<Tabs>
<Tab title="Log analysis">

Filter requests that originate from a known IPv6 subnet.

**Query**

```kusto
['sample-http-logs']
| extend is_internal = ipv6_is_match(id, '2001:db8::/32')
| where is_internal
| project _time, id, uri, method, status
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D) %7C extend is_internal%20%3D%20ipv6_is_match(id%2C%20'2001%3Adb8%3A%3A%2F32') %7C where is_internal %7C project _time%2C id%2C uri%2C method%2C status%22%7D)

**Output**

| _time               | id                 | uri         | method | status |
| -------------------- | ------------------ | ----------- | ------ | ------ |
| 2025-06-28T13:04:10Z | 2001:db8:abcd::1 | /health     | GET    | 200    |
| 2025-06-28T13:05:22Z | 2001:db8:beef::2 | /api/orders | POST   | 201    |

This query identifies log entries where the request ID is an IPv6 address within the `2001:db8::/32` range.

</Tab>
<Tab title="OpenTelemetry traces">

Isolate span activity from a simulated IPv6-enabled service mesh.

**Query**

```kusto
['otel-demo-traces']
| extend is_mesh = ipv6_is_match(span_id, '2001:db8:ac10::/40')
| where is_mesh
| project _time, span_id, trace_id, ['service.name'], kind, status_code
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'otel-demo-traces'%5D](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'otel-demo-traces'%5D) %7C extend is_mesh%20%3D%20ipv6_is_match(span_id%2C%20'2001%3Adb8%3Aac10%3A%3A%2F40') %7C where is_mesh %7C project _time%2C span_id%2C trace_id%2C%20%5B'service.name'%5D%2C kind%2C status_code%22%7D)

**Output**

| _time               | span_id              | trace_id | service.name    | kind   | status_code |
| -------------------- | --------------------- | --------- | --------------- | ------ | ------------ |
| 2025-06-28T14:10:44Z | 2001:db8:ac10::beef | abc123efg | frontend        | server | OK           |
| 2025-06-28T14:11:22Z | 2001:db8:ac10::dead | xyz456hij | checkoutservice | client | OK           |

This query selects spans whose `span_id` resembles IPv6 addresses in a specific subnet, simulating trace analysis from a mesh network layer.

</Tab>
<Tab title="Security logs">

Detect suspicious traffic patterns originating from a specific IPv6 subnet.

**Query**

```kusto
['sample-http-logs']
| extend is_suspicious = ipv6_is_match(id, 'fd00:1337::/48')
| where is_suspicious
| summarize count() by uri, status, ['geo.country']
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D) %7C extend is_suspicious%20%3D%20ipv6_is_match(id%2C%20'fd00%3A1337%3A%3A%2F48') %7C where is_suspicious %7C summarize count()%20by%20uri%2C%20status%2C%20%5B'geo.country'%5D%22%7D)

**Output**

| uri             | status | geo.country | count |
| --------------- | ------ | ----------- | ----- |
| /admin/login    | 401    | ZZ          | 22    |
| /api/deleteUser | 403    | ZZ          | 12    |

This query identifies requests coming from the `fd00:1337::/48` subnet and aggregates by URI and status code, highlighting suspicious endpoints and access attempts.

</Tab>
</Tabs>

## List of related functions

- [ipv4_is_match](/apl/scalar-functions/ip-functions/ipv4-is-match): Checks whether an IPv4 address belongs to a specified IPv4 subnet. Use it when working with IPv4 addresses.
- [parse_ipv4](/apl/scalar-functions/ip-functions/parse-ipv4): Parses a string into an IPv4 address. Use it when working with raw IPv4 strings.
