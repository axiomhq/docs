---
title: has_ipv4_prefix
description: 'This page explains how to use the has_ipv4_prefix function in APL.'
---

The `has_ipv4_prefix` function checks if an IPv4 address starts with a specified prefix. Use this function to filter or match IPv4 addresses efficiently based on their prefixes. It is particularly useful when analyzing network traffic, identifying specific address ranges, or working with CIDR-based IP filtering in datasets.

## For users of other query languages

If you come from other query languages, this section explains how to adjust your existing queries to achieve the same results in APL.

<AccordionGroup>
<Accordion title="Splunk SPL users">

In Splunk SPL, you use string-based matching or CIDR functions for IP comparison. In APL, `has_ipv4_prefix` simplifies the process by directly comparing an IP against a prefix.

<CodeGroup>

```sql Splunk example
| eval is_match = if(cidrmatch("192.168.0.0/24", ip), true, false)
```

```kusto APL equivalent
['sample-http-logs']
| where has_ipv4_prefix(uri, "192.168.0")
```

</CodeGroup>

</Accordion>
<Accordion title="ANSI SQL users">

In ANSI SQL, there is no direct equivalent to `has_ipv4_prefix`. You would typically use substring or LIKE operators for partial matching. APL provides a dedicated function for this purpose, ensuring simplicity and accuracy.

<CodeGroup>

```sql SQL example
SELECT *
FROM sample_http_logs
WHERE ip LIKE '192.168.0%'
```

```kusto APL equivalent
['sample-http-logs']
| where has_ipv4_prefix(uri, "192.168.0")
```

</CodeGroup>

</Accordion>
</AccordionGroup>

## Usage

### Syntax

```kusto
has_ipv4_prefix(column_name, prefix)
```

### Parameters

| Parameter     | Type   | Description                                                     |
|---------------|--------|-----------------------------------------------------------------|
| `column_name` | string | The column containing the IPv4 addresses to evaluate.          |
| `prefix`      | string | The prefix to check for, expressed as a string (e.g., "192.0"). |

### Returns

- Returns a Boolean (`true` or `false`) indicating whether the IPv4 address starts with the specified prefix.

## Use case examples

<Tabs>
<Tab title="Log analysis">

Use `has_ipv4_prefix` to filter logs for requests originating from a specific IP range.

**Query**

```kusto
['sample-http-logs']
| where has_ipv4_prefix(geo.country, '192.168.0')
| project _time, id, uri, geo.city
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/explorer?initForm=%7B%22apl%22%3A%22%5B%27sample-http-logs%27%5D%20%7C%20where%20has_ipv4_prefix%28geo.country%2C%20%27192.168.0%27%29%20%7C%20project%20_time%2C%20id%2C%20uri%2C%20geo.city%22%7D)

**Output**

| _time                 | id       | uri                     | geo.city |
|-----------------------|----------|-------------------------|----------|
| 2024-11-01T12:00:00Z | user123  | /api/login              | New York |
| 2024-11-01T12:05:00Z | user456  | /api/orders             | Chicago  |

This query identifies all requests from IPs within the `192.168.0` prefix, showing only the relevant fields for analysis.

</Tab>
<Tab title="OpenTelemetry traces">

Identify backend service calls originating from specific IP ranges.

**Query**

```kusto
['otel-demo-traces']
| where has_ipv4_prefix(service.name, '10.0.0')
| project _time, trace_id, span_id, service.name
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/explorer?initForm=%7B%22apl%22%3A%22%5B%27otel-demo-traces%27%5D%20%7C%20where%20has_ipv4_prefix%28service.name%2C%20%2710.0.0%27%29%20%7C%20project%20_time%2C%20trace_id%2C%20span_id%2C%20service.name%22%7D)

**Output**

| _time                 | trace_id    | span_id     | service.name       |
|-----------------------|-------------|-------------|--------------------|
| 2024-11-01T12:10:00Z | trace12345  | span12345   | frontend           |
| 2024-11-01T12:15:00Z | trace67890  | span67890   | checkoutservice    |

This query finds traces from services with IPs under the `10.0.0` range, helping with network-level analysis.

</Tab>
<Tab title="Security logs">

Analyze security events to locate activity from specific IP ranges.

**Query**

```kusto
['sample-http-logs']
| where has_ipv4_prefix(geo.city, '172.16')
| summarize count() by geo.city
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/explorer?initForm=%7B%22apl%22%3A%22%5B%27sample-http-logs%27%5D%20%7C%20where%20has_ipv4_prefix%28geo.city%2C%20%27172.16%27%29%20%7C%20summarize%20count%28%29%20by%20geo.city%22%7D)

**Output**

| geo.city      | count |
|---------------|-------|
| New York      | 5     |
| San Francisco | 8     |

This query summarizes the number of events for each city originating from the `172.16` IP range, useful for tracking unusual activity.

</Tab>
</Tabs>

## List of related functions

- [**has_ipv4**](/apl/ip-functions/has_ipv4-function): Determines if a string contains a valid IPv4 address. Use to validate IP addresses before applying `has_ipv4_prefix`.
- [**parse_ipv4**](/apl/ip-functions/parse_ipv4-function): Parses and converts an IPv4 address into a structured type for advanced operations.
- [**ipv4_compare**](/apl/ip-functions/ipv4_compare-function): Compares two IPv4 addresses lexicographically. Use for sorting or range evaluations.