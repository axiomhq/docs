---
title: geo_info_from_ip_address
description: 'This page explains how to use the geo_info_from_ip_address function in APL.'
---

The `geo_info_from_ip_address` function in APL retrieves geographic information based on an IP address. It maps an IP address to attributes such as city, region, and country, allowing you to perform location-based analytics on your datasets. This function is particularly useful for analyzing web logs, security events, and telemetry data to uncover geographic trends or detect anomalies based on location.

## For users of other query languages

If you come from other query languages, this section explains how to adjust your existing queries to achieve the same results in APL.

<AccordionGroup>
<Accordion title="Splunk SPL users">

In Splunk, the equivalent process often involves using lookup tables or add-ons to resolve IP addresses into geographic details. In APL, `geo_info_from_ip_address` performs the resolution natively within the query, streamlining the workflow.

<CodeGroup>
```sql Splunk example
| eval geo_info = iplocation(client_ip)
```

```kusto APL equivalent
['sample-http-logs']
| extend geo_info = geo_info_from_ip_address(client_ip)
```
</CodeGroup>

</Accordion>
<Accordion title="ANSI SQL users">

In SQL, geographic information retrieval typically requires a separate database or API integration. In APL, the `geo_info_from_ip_address` function directly provides geographic details, simplifying the query process.

<CodeGroup>
```sql SQL example
SELECT ip_to_location(client_ip) AS geo_info
FROM sample_http_logs
```

```kusto APL equivalent
['sample-http-logs']
| extend geo_info = geo_info_from_ip_address(client_ip)
```
</CodeGroup>

</Accordion>
</AccordionGroup>

## Usage

### Syntax

```kusto
geo_info_from_ip_address(ip_address)
```

### Parameters

| Parameter   | Type   | Description                                  |
|-------------|--------|----------------------------------------------|
| `ip_address` | string | The IP address for which to retrieve geographic information. |

### Returns

The function returns a dynamic object containing geographic attributes such as `city`, `region`, and `country`.

## Use case examples

<Tabs>
<Tab title="Log analysis">

Using geographic data to analyze web log traffic.

**Query**

```kusto
['sample-http-logs']
| extend geo_info = geo_info_from_ip_address(client_ip)
| summarize request_count = count() by geo_info['country'], geo_info['city']
| top 10 by request_count
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/explorer?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D%20%7C%20extend%20geo_info%20%3D%20geo_info_from_ip_address(client_ip)%20%7C%20summarize%20request_count%20%3D%20count()%20by%20geo_info%5B'country'%5D%2C%20geo_info%5B'city'%5D%20%7C%20top%2010%20by%20request_count%22%7D)

**Output**

| country       | city        | request_count |
|---------------|-------------|---------------|
| United States | San Jose    | 234           |
| Canada        | Toronto     | 189           |

This query identifies the top 10 cities by web request count, helping you pinpoint areas with the most traffic.

</Tab>
<Tab title="OpenTelemetry traces">

Using geographic data for trace analysis in a distributed system.

**Query**

```kusto
['otel-demo-traces']
| extend geo_info = geo_info_from_ip_address(client_ip)
| summarize avg_duration = avg(duration) by geo_info['country'], geo_info['city']
| order by avg_duration desc
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/explorer?initForm=%7B%22apl%22%3A%22%5B'otel-demo-traces'%5D%20%7C%20extend%20geo_info%20%3D%20geo_info_from_ip_address(client_ip)%20%7C%20summarize%20avg_duration%20%3D%20avg(duration)%20by%20geo_info%5B'country'%5D%2C%20geo_info%5B'city'%5D%20%7C%20order%20by%20avg_duration%20desc%22%7D)

**Output**

| country       | city        | avg_duration |
|---------------|-------------|--------------|
| Australia     | Sydney      | 342ms        |
| Japan         | Tokyo       | 298ms        |

This query shows average trace durations grouped by geographic location.

</Tab>
<Tab title="Security logs">

Analyzing geographic patterns in security events.

**Query**

```kusto
['sample-http-logs']
| extend geo_info = geo_info_from_ip_address(client_ip)
| where status == '403'
| summarize blocked_requests = count() by geo_info['country'], geo_info['city']
| top 5 by blocked_requests
```

[Run in Playground](https://play.axiom.co/axiom-play-qf1k/explorer?initForm=%7B%22apl%22%3A%22%5B'sample-http-logs'%5D%20%7C%20extend%20geo_info%20%3D%20geo_info_from_ip_address(client_ip)%20%7C%20where%20status%20%3D%3D%20'403'%20%7C%20summarize%20blocked_requests%20%3D%20count()%20by%20geo_info%5B'country'%5D%2C%20geo_info%5B'city'%5D%20%7C%20top%205%20by%20blocked_requests%22%7D)

**Output**

| country       | city        | blocked_requests |
|---------------|-------------|------------------|
| Germany       | Berlin      | 50               |
| India         | Mumbai      | 45               |

This query highlights locations with the highest number of blocked requests, helping you identify potential sources of malicious activity.

</Tab>
</Tabs>

## List of related functions

- [**parse_ip**](/apl/string-functions/parse_ip-function): Parses an IP address into components like network and host.
- [**geo_distance_2points**](/apl/geo-functions/geo_distance_2points-function): Calculates the distance between two geographic coordinates.
- [**geo_point_in_polygon**](/apl/geo-functions/geo_point_in_polygon-function): Checks whether a geographic point lies within a given polygon.