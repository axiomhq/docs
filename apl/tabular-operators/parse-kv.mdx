---
title: parse-kv
description: 'This page explains how to use the parse-kv operator in APL.'
---

The `parse-kv` operator extracts key–value pairs from text into structured columns. Use this operator when your dataset contains unstructured or semi-structured logs where information is embedded in free-form text, such as query strings, headers, or attributes. Instead of manually parsing substrings, `parse-kv` automatically splits the input into keys and values based on delimiters that you specify.

You find this operator useful in scenarios such as analyzing log entries with embedded metadata, extracting attributes from OpenTelemetry spans, or parsing security event messages where structured fields are embedded inside a single string.

## For users of other query languages

If you come from other query languages, this section explains how to adjust your existing queries to achieve the same results in APL.

<AccordionGroup>
<Accordion title="Splunk SPL users">

In Splunk SPL, you typically use the `kv` or `extract` command to pull key–value fields from raw events. In APL, `parse-kv` serves the same purpose but offers explicit control over delimiters and the ability to map extracted keys into new columns.

<CodeGroup>

```sql Splunk example
... | kv pairdelim=" " kvdelim="="
````

```kusto APL equivalent
['sample-http-logs']
| extend parsed = parse-kv('uri', pair_delimiter='&', kv_delimiter='=')
```

</CodeGroup>

</Accordion>
<Accordion title="ANSI SQL users">

ANSI SQL does not include a built-in function to parse arbitrary key–value pairs from text. You typically rely on `SUBSTRING`, `SPLIT`, or regular expressions. In APL, `parse-kv` encapsulates this functionality in one operator, making key–value extraction more concise and efficient.

<CodeGroup>

```sql SQL example
SELECT
  SUBSTRING_INDEX(SUBSTRING_INDEX(uri, '&', 1), '=', -1) AS key1,
  SUBSTRING_INDEX(SUBSTRING_INDEX(uri, '&', 2), '=', -1) AS key2
FROM logs
```

```kusto APL equivalent
['sample-http-logs']
| extend parsed = parse-kv('uri', pair_delimiter='&', kv_delimiter='=')
```

</CodeGroup>

</Accordion>
</AccordionGroup>

## Usage

### Syntax

```kusto
parse-kv(Expression [, pair_delimiter [, kv_delimiter [, quote_delimiter]]])
```

### Parameters

| Parameter         | Type     | Description                                                                          |
| ----------------- | -------- | ------------------------------------------------------------------------------------ |
| `Expression`      | `string` | The string expression that contains key–value pairs.                                 |
| `pair_delimiter`  | `string` | Character that separates key–value pairs. Default is a space (`' '`).                |
| `kv_delimiter`    | `string` | Character that separates keys from values. Default is `'='`.                         |
| `quote_delimiter` | `string` | Character that surrounds values with spaces or special characters. Default is `'"'`. |

### Returns

A dynamic object containing the extracted key–value pairs. You can project individual keys as new columns or keep the object for further processing.

## Use case examples

<Tabs>
<Tab title="Log analysis">

You can extract query parameters from HTTP request URIs to analyze how users interact with your service.

**Query**

```kusto
['sample-http-logs']
| extend kv = parse-kv(uri, pair_delimiter='&', kv_delimiter='=')
| project _time, id, method, kv
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22['sample-http-logs](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22['sample-http-logs)'] | extend kv = parse-kv(uri, pair_delimiter='&', kv_delimiter='=') | project _time, id, method, kv%22%7D)

**Output**

| _time               | id   | method | kv                                |
| -------------------- | ---- | ------ | --------------------------------- |
| 2025-09-01T10:01:00Z | u123 | GET    | {"q":"search","page":"1"}         |
| 2025-09-01T10:02:00Z | u456 | POST   | {"action":"login","next":"/home"} |

This query parses the query string parameters in the `uri` field and projects them into a structured dynamic object.

</Tab>
<Tab title="OpenTelemetry traces">

You can extract attributes embedded in trace span IDs or metadata.

**Query**

```kusto
['otel-demo-traces']
| extend kv = parse-kv(span_id, pair_delimiter='-', kv_delimiter=':')
| project _time, trace_id, ['service.name'], kv
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22['otel-demo-traces](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22['otel-demo-traces)'] | extend kv = parse-kv(span_id, pair_delimiter='-', kv_delimiter=':') | project _time, trace_id, ['service.name'], kv%22%7D)

**Output**

| _time               | trace_id | service.name    | kv                            |
| -------------------- | --------- | --------------- | ----------------------------- |
| 2025-09-01T10:03:00Z | t789      | frontend        | {"part1":"abc","part2":"xyz"} |
| 2025-09-01T10:04:00Z | t101      | checkoutservice | {"part1":"def","part2":"uvw"} |

This query breaks down structured identifiers in `span_id` into key–value components for easier analysis.

</Tab>
<Tab title="Security logs">

You can parse structured information inside log messages, such as extracting action and result fields.

**Query**

```kusto
['sample-http-logs']
| extend kv = parse-kv(uri, pair_delimiter=';', kv_delimiter='=')
| project _time, status, ['geo.country'], kv
```

[Run in Playground]([https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22['sample-http-logs](https://play.axiom.co/axiom-play-qf1k/query?initForm=%7B%22apl%22%3A%22['sample-http-logs)'] | extend kv = parse-kv(uri, pair_delimiter=';', kv_delimiter='=') | project _time, status, ['geo.country'], kv%22%7D)

**Output**

| _time               | status | geo.country | kv                                    |
| -------------------- | ------ | ----------- | ------------------------------------- |
| 2025-09-01T10:05:00Z | 403    | US          | {"action":"access","result":"denied"} |
| 2025-09-01T10:06:00Z | 200    | DE          | {"action":"login","result":"success"} |

This query parses embedded key–value fields from the `uri` to identify blocked and successful login attempts by country.

</Tab>
</Tabs>

## List of related operators

- [parse-json](/apl/scalar-functions/parse-json-function): Use when the string is already in JSON format. More efficient than `parse-kv` for JSON data.
- [extract](/apl/scalar-functions/extract-function): Use for regular expression-based extraction when data is less structured.
- [split](/apl/scalar-functions/split-function): Use when you need to split strings into arrays instead of key–value objects.
- [mv-expand](/apl/tabular-operators/mv-expand-operator): Use to expand dynamic arrays or property bags into separate rows after parsing.
- [project](/apl/tabular-operators/project-operator): Use to select and rename specific extracted keys for further analysis.
